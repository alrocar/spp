"use strict";var demo=function(n){var a={pattern:".pattern",card:".card",cardImage:".card__image",cardClose:".card__btn-close"},e={patternHidden:"pattern--hidden",polygon:"polygon",polygonHidden:"polygon--hidden"},t={index:"data-index",id:"data-id"},i={paths:null,points:null},r={},d=function(){var a=Trianglify({width:n.innerWidth,height:n.innerHeight,cell_size:90,variance:1,stroke_width:1,x_colors:"random",y_colors:"random"}).svg();o(a),c(),g(),p("",v(location.href))},o=function(n){$(a.pattern).append(n),i.paths=[].slice.call(n.childNodes),i.points=[],i.paths.forEach(function(n){$(n).attr("class",e.polygon);var a=n.getBoundingClientRect(),t={x:a.left+a.width/2,y:a.top+a.height/2};i.points.push(t)}),$(a.pattern).removeClass(e.patternHidden)},c=function(){var n=$(a.card);$.each(n,function(n,e){var i=new Card(e,n);r[e]={card:i};var d=$(n);d.attr(t.index,e+"");var o=d.find(a.cardImage),c=d.find(a.cardClose);$(o).on("click",function(){location.hash=d.attr(t.id)}),$(c).on("click",function(){location.hash=""})})},l=function(n,e){var t=r[e].card;if(!t.isOpen||!n){var i=new TimelineLite({paused:!0}),d=s(e);if(t.isOpen){var o=t.closeCard(),c=.8*o.duration();i.add(o),i.add(d,c)}else h($(this).find(a.cardImage).find("image")),i.add(d),i.add(t.openCard(u),0);i.play()}},s=function(n){var a=new TimelineLite,e=r[n].card;for(var t in r)if(r.hasOwnProperty(t)){var i=r[t].card;i.id===n||e.isOpen||a.add(i.hideCard(),0),i.id!==n&&e.isOpen&&a.add(i.showCard(),0)}return a},h=function(n){var e=$(n).attr("xlink:href");$(a.pattern).css("background-image","url("+e+")")},u=function(n){var a=n.width/2,t={x:n.x,y:n.y};i.points.forEach(function(n,r){f(n,a,t)?$(i.paths[r]).attr("class",e.polygon+" "+e.polygonHidden):$(i.paths[r]).attr("class",e.polygon)})},f=function(n,a,e){var t=n.x,i=n.y,r=e.x,d=e.y,o=a*a;return Math.pow(t-r,2)+Math.pow(i-d,2)<=o},p=function(n,a){var e=function(n){var a=$(n).attr(t.index);return parseInt(a,10)};if(n){var i=$("["+t.id+'="'+n+'"]')[0];i&&l.call(i,!1,e(i))}if(a){var r=$("["+t.id+'="'+a+'"]')[0];r&&l.call(r,!0,e(r))}},v=function(n){var a=document.createElement("a");return a.href=n,a.hash.slice(1)},g=function(){n.HashChangeEvent||function(){var a=document.URL;n.addEventListener("hashchange",function(n){Object.defineProperty(n,"oldURL",{enumerable:!0,configurable:!0,value:a}),Object.defineProperty(n,"newURL",{enumerable:!0,configurable:!0,value:document.URL}),a=document.URL})}(),n.addEventListener("hashchange",function(n){var a=v(n.newURL),e=v(n.oldURL);p(e,a)})};return{init:d}}(window);window.onload=demo.init;